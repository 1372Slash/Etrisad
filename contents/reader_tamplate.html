<!DOCTYPE html>
<html lang="id" class="scroll-smooth">

<head>
    <base href="../">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharrow - Chapter Viewer | Etrisad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Material Symbols -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Modern Font (Geist Sans) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/geist-sans@5.0.3/css/all.min.css">
    <link rel="icon" type="image/png" href="assets/images/etrisad_icon.png">
    <link rel="stylesheet" href="assets/css/style.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Parkinsans"', 'sans-serif'],
                    },
                    colors: {
                        primary: '#0A0A0A',
                        secondary: '#0B5939',
                        accent: '#F5E6A8',
                        'brand-gray': '#1E1E1E'
                    },
                    backdropBlur: {
                        xl: '24px',
                    },
                }
            }
        }
    </script>
    <style>
        @font-face {
            font-family: Ribes;
            src: url(assets/fonts/Ribes-Regular.otf);
        }

        @font-face {
            font-family: Parkinsans;
            src: url(assets/fonts/Parkinsans-Regular.ttf);
        }

        .font-nauryz {
            font-family: Ribes, sans-serif;
        }

        .font-space {
            font-family: Parkinsans, sans-serif;
        }

        /* Reading mode styles */
        .reading-content {
            line-height: 1.8;
            font-size: 1.125rem;
        }

        .reading-content p {
            margin-bottom: 1.5rem;
            text-align: justify;
        }

        .reading-content h1,
        .reading-content h2,
        .reading-content h3 {
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        /* Theme variables */
        :root {
            --reading-bg: #0A0A0A;
            --reading-text: #E5E5E5;
            --reading-accent: #F5E6A8;
        }

        .theme-sepia {
            --reading-bg: #F4F1EA;
            --reading-text: #5C4B37;
            --reading-accent: #8B4513;
        }

        .theme-dark {
            --reading-bg: #1A1A1A;
            --reading-text: #D1D5DB;
            --reading-accent: #F59E0B;
        }

        /* Navbar styles */
        .glass-effect,
        .pill-navbar {
            background: rgba(16, 16, 16, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        #navbar-container {
            border: 1px solid transparent;
            border-radius: 16px;
            transition:
                border-radius 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                padding 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                background 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                border-color 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                border-width 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                box-shadow 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            padding-left: 24px;
        }

            @media (min-width: 1280px) {
        #navbar-container {
            max-width: 1100px;
            width: 80%;
        }
    }

        /* Pill navbar effect */
        /* @media (min-width: 1024px) {
            #navbar-container {
                max-width: 1100px;
                margin: 0 auto;
                border-radius: 50px;
            }
        } */

        .pill-navbar {
            border-color: rgba(255, 255, 255, 0.10) !important;
        }

        .reading-area {
            background-color: var(--reading-bg);
            color: var(--reading-text);
        }

        .reading-controls {
            position: fixed;
            top: 50%;
            right: 2rem;
            transform: translateY(-50%);
            z-index: 30;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .reading-controls:hover {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .reading-controls {
                position: fixed;
                bottom: 2rem;
                right: 1rem;
                top: auto;
                transform: none;
                flex-direction: row;
                background: rgba(30, 30, 30, 0.9);
                backdrop-filter: blur(10px);
                padding: 0.75rem;
                border-radius: 1rem;
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
        }

        /* Tambahan agar icon benar-benar center */
        .material-symbols-outlined {
            display: flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            line-height: 1 !important;
            font-size: 2rem !important;
        }
    </style>
</head>

<body class="bg-primary font-sans">
    <!-- Navigation Bar -->
    <header id="navbar" class="fixed top-0 left-0 right-0 z-40 transition-all duration-500 ease-in-out">
        <div id="navbar-container" class="transition-all duration-500 ease-in-out pl-8 pr-6 py-3">
            <div class="flex items-center justify-between">
                <div class="center flex items-center gap-4">
                    <a href="contents/sharrow.html"
                        class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center">
                        <span
                            class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">arrow_back</span>
                    </a>
                    <div>
                        <h1 class="text-lg font-semibold text-white font-nauryz" id="chapter-title">Sharrow - Act 1:
                            Surat</h1>
                        <p class="text-sm text-gray-400" id="chapter-info">Chapter 1 of 12</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <!-- Chapter Navigation -->
                    <button id="prev-chapter"
                        class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center">
                        <span
                            class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">chevron_left</span>
                    </button>
                    <button id="next-chapter"
                        class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center">
                        <span
                            class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">chevron_right</span>
                    </button>
                    <!-- Settings -->
                    <button id="settings-btn"
                        class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors flex items-center justify-center">
                        <span
                            class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">settings</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Reading Settings Panel -->
    <div id="settings-panel"
        class="fixed top-20 right-6 w-80 bg-primary/95 backdrop-blur-xl rounded-xl shadow-2xl border border-white/10 z-50 hidden">
        <div class="p-6">
            <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined">tune</span>
                Reading Settings
            </h3>

            <!-- Theme Selection -->
            <div class="mb-4">
                <label class="text-sm font-medium text-gray-300 mb-2 block">Theme</label>
                <div class="grid grid-cols-3 gap-2">
                    <button
                        class="theme-btn p-3 rounded-lg border-2 transition-colors bg-primary border-accent text-white"
                        data-theme="default">
                        <div class="w-4 h-4 bg-primary rounded mx-auto mb-1"></div>
                        <span class="text-xs">Dark</span>
                    </button>
                    <button
                        class="theme-btn p-3 rounded-lg border-2 transition-colors bg-gray-800 border-transparent text-white"
                        data-theme="dark">
                        <div class="w-4 h-4 bg-gray-800 rounded mx-auto mb-1"></div>
                        <span class="text-xs">Black</span>
                    </button>
                    <button
                        class="theme-btn p-3 rounded-lg border-2 transition-colors bg-amber-50 border-transparent text-amber-900"
                        data-theme="sepia">
                        <div class="w-4 h-4 bg-amber-50 rounded mx-auto mb-1"></div>
                        <span class="text-xs">Sepia</span>
                    </button>
                </div>
            </div>

            <!-- Font Size -->
            <div class="mb-4">
                <label class="text-sm font-medium text-gray-300 mb-2 block">Font Size</label>
                <div class="flex items-center gap-4">
                    <button id="font-decrease" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors">
                        <span class="material-symbols-outlined text-sm">remove</span>
                    </button>
                    <span id="font-size-display" class="text-white font-medium">18px</span>
                    <button id="font-increase" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors">
                        <span class="material-symbols-outlined text-sm">add</span>
                    </button>
                </div>
            </div>

            <!-- Line Height -->
            <div class="mb-4">
                <label class="text-sm font-medium text-gray-300 mb-2 block">Line Height</label>
                <input type="range" id="line-height" min="1.4" max="2.2" step="0.1" value="1.8" class="w-full">
            </div>
        </div>
    </div>

    <!-- Main Reading Area -->
    <main class="reading-area transition-colors duration-300 pt-28 pb-12">
        <div class="container mx-auto max-w-4xl px-6">
            <article class="reading-content" id="chapter-content">
                <!-- Chapter content will be loaded here -->
                <div class="text-center mb-12">
                    <h1 class="gradient-text text-4xl font-bold mb-4 font-nauryz" style="color: var(--reading-accent);">
                        Act 1: Surat</h1>
                    <div class="w-24 h-0.5 bg-current mx-auto opacity-50"></div>
                </div>

                <div class="prose prose-lg max-w-none" style="color: var(--reading-text);">
                    <p>Pagi itu, seperti biasa, aku bangun dengan suara alarm yang memekakkan telinga. Hari Minggu yang
                        seharusnya menjadi hari istirahat, tapi entah kenapa aku selalu bangun pagi. Kebiasaan yang
                        sulit dihilangkan setelah bertahun-tahun bekerja.</p>

                    <p>Ketika aku membuka pintu untuk mengambil koran pagi, mataku tertuju pada sesuatu yang aneh.
                        Sebuah surat putih tergeletak di depan pintu, tanpa nama pengirim atau alamat. Hanya surat polos
                        berwarna putih yang terlihat sangat misterius.</p>

                    <p>Dengan hati-hati, aku mengambil surat itu. Tidak ada berat yang berarti, seolah-olah di dalamnya
                        kosong. Aku membuka perlahan, dan benar saja—surat itu kosong. Tidak ada tulisan, tidak ada
                        gambar, hanya kertas putih kosong yang menatapku dengan dingin.</p>

                    <p>"Aneh," gumamku dalam hati. Siapa yang mengirim surat kosong? Dan untuk apa?</p>

                    <p>Tiba-tiba, dunia di sekitarku mulai berubah. Warna-warna mulai memudar, dan aku merasakan sesuatu
                        yang aneh. Ketika aku mengangkat kepala, aku tidak lagi berada di depan rumahku. Di hadapanku
                        terbentang lorong yang panjang dan gelap, dengan dinding-dinding batu yang terlihat sangat tua.
                    </p>

                    <p>Surat dalam tanganku perlahan menghilang seperti debu yang terbawa angin. Aku mencoba berteriak,
                        tapi suaraku seperti tertelan oleh kegelapan lorong yang menakutkan ini.</p>

                    <p>"Di mana aku?" teriakku, tapi hanya gema yang menjawab. Gema yang terdengar seperti tawa
                        misterius yang bergaung di sepanjang lorong.</p>

                    <p>Dengan langkah yang ragu-ragu, aku mulai menyusuri lorong itu. Tidak ada pilihan lain. Aku harus
                        mencari jalan keluar dari tempat aneh ini, tempat yang sepertinya bukan milik dunia nyata.</p>

                    <p>Lorong itu terasa tidak berujung. Setiap langkah yang kuambil hanya membawaku lebih dalam ke
                        dalam kegelapan. Dan aku mulai merasakan bahwa ada sesuatu yang mengikutiku dari
                        belakang—sesuatu yang tidak ingin aku lihat.</p>
                </div>
            </article>

            <!-- Chapter Navigation Footer -->
            <div class="flex justify-between items-center mt-16 pt-8 border-t border-white/10">
                <button id="prev-chapter-footer"
                    class="flex items-center gap-2 px-6 py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed scale-75 md:scale-100">
                    <span class="material-symbols-outlined">chevron_left</span>
                    <span>Previous Chapter</span>
                </button>
                <div class="text-center">
                    <p class="text-gray-400 text-sm">Chapter 1 of 12</p>
                    <div class="w-32 bg-white/10 h-1 rounded-full mt-2">
                        <div class="bg-accent h-1 rounded-full" style="width: 8.33%;"></div>
                    </div>
                </div>
                <button id="next-chapter-footer"
                    class="flex items-center gap-2 btn-accent px-6 py-3 rounded-full font-semibold text-base glow-on-hover scale-75 md:scale-100">
                    <span>Next Chapter</span>
                    <span class="material-symbols-outlined">chevron_right</span>
                </button>
            </div>
        </div>
    </main>

    <!-- Reading Controls (Floating) -->
    <div class="reading-controls flex items-center justify-center">
        <!-- <button id="bookmark-btn" class="p-3 rounded-full bg-brand-gray/90 backdrop-blur-xl border border-white/10 hover:bg-brand-gray transition-colors flex items-center justify-center">
            <span class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">bookmark_border</span>
        </button> -->
        <button id="fullscreen-btn"
            class="p-3 rounded-full bg-brand-gray/90 backdrop-blur-xl border border-white/10 hover:bg-brand-gray transition-colors flex items-center justify-center">
            <span
                class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">fullscreen</span>
        </button>
        <button id="share-btn"
            class="p-3 rounded-full bg-brand-gray/90 backdrop-blur-xl border border-white/10 hover:bg-brand-gray transition-colors flex items-center justify-center">
            <span
                class="material-symbols-outlined text-white text-2xl leading-none flex items-center justify-center">share</span>
        </button>
    </div>

    <script>
        // Chapter data
        const chapters = [
            { id: 1, title: "Act 1: Surat", date: "May 18, 2023" },
            { id: 2, title: "Act 2: Lorong", date: "May 19, 2023" },
            { id: 3, title: "Act 3: Desa", date: "May 22, 2023" },
            { id: 4, title: "Act 4: Sisi", date: "May 23, 2023" },
            { id: 5, title: "Act 5: Museum", date: "May 24, 2023" }
        ];

        let currentChapter = 1;
        let fontSize = 18;
        let currentTheme = 'default';

        // Get chapter from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const chapterParam = urlParams.get('chapter');
        if (chapterParam) {
            currentChapter = parseInt(chapterParam);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function () {
            updateChapterInfo();
            setupEventListeners();
            loadUserSettings();
            initializeNavbarAnimation();
        });

        function initializeNavbarAnimation() {
            // --- Navbar scroll effect ---
            window.addEventListener('scroll', function () {
                const navbar = document.getElementById('navbar');
                const navbarContainer = document.getElementById('navbar-container');

                if (!navbarContainer) return;

                if (window.scrollY > 50) {
                    navbar.classList.add('p-3');
                    navbarContainer.classList.add('pill-navbar', 'rounded-full', 'border-white/10');
                    navbarContainer.classList.remove('rounded-xl', 'border-transparent');
                } else {
                    navbar.classList.remove('p-3');
                    navbarContainer.classList.remove('pill-navbar', 'rounded-full', 'border-white/10');
                    navbarContainer.classList.add('rounded-xl', 'border-transparent');
                }
            });
        }

        function updateChapterInfo() {
            const chapter = chapters[currentChapter - 1];
            if (chapter) {
                document.getElementById('chapter-title').textContent = `Sharrow - ${chapter.title}`;
                document.getElementById('chapter-info').textContent = `Chapter ${currentChapter} of ${chapters.length}`;

                // Update navigation buttons
                document.getElementById('prev-chapter').disabled = currentChapter === 1;
                document.getElementById('next-chapter').disabled = currentChapter === chapters.length;
                document.getElementById('prev-chapter-footer').disabled = currentChapter === 1;
                document.getElementById('next-chapter-footer').disabled = currentChapter === chapters.length;

                // Update progress bar
                const progressBar = document.querySelector('.bg-accent');
                if (progressBar) {
                    progressBar.style.width = `${(currentChapter / chapters.length) * 100}%`;
                }
            }
        }

        function setupEventListeners() {
            // Settings panel toggle
            document.getElementById('settings-btn').addEventListener('click', function () {
                const panel = document.getElementById('settings-panel');
                panel.classList.toggle('hidden');
            });

            // Close settings when clicking outside
            document.addEventListener('click', function (e) {
                const panel = document.getElementById('settings-panel');
                const settingsBtn = document.getElementById('settings-btn');
                if (!panel.contains(e.target) && !settingsBtn.contains(e.target)) {
                    panel.classList.add('hidden');
                }
            });

            // Theme buttons
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const theme = this.dataset.theme;
                    changeTheme(theme);
                });
            });

            // Font size controls
            document.getElementById('font-increase').addEventListener('click', function () {
                if (fontSize < 24) {
                    fontSize += 2;
                    updateFontSize();
                }
            });

            document.getElementById('font-decrease').addEventListener('click', function () {
                if (fontSize > 12) {
                    fontSize -= 2;
                    updateFontSize();
                }
            });

            // Line height control
            document.getElementById('line-height').addEventListener('input', function () {
                const lineHeight = this.value;
                document.querySelector('.reading-content').style.lineHeight = lineHeight;
                localStorage.setItem('reader-line-height', lineHeight);
            });

            // Chapter navigation
            document.getElementById('prev-chapter').addEventListener('click', () => navigateChapter(-1));
            document.getElementById('next-chapter').addEventListener('click', () => navigateChapter(1));
            document.getElementById('prev-chapter-footer').addEventListener('click', () => navigateChapter(-1));
            document.getElementById('next-chapter-footer').addEventListener('click', () => navigateChapter(1));

            // Keyboard navigation
            document.addEventListener('keydown', function (e) {
                if (e.key === 'ArrowLeft') navigateChapter(-1);
                if (e.key === 'ArrowRight') navigateChapter(1);
                if (e.key === 'Escape') document.getElementById('settings-panel').classList.add('hidden');
            });

            // Reading controls
            // document.getElementById('bookmark-btn').addEventListener('click', function() {
            //     const icon = this.querySelector('.material-symbols-outlined');
            //     if (icon.textContent === 'bookmark_border') {
            //         icon.textContent = 'bookmark';
            //         this.classList.add('text-accent');
            //     } else {
            //         icon.textContent = 'bookmark_border';
            //         this.classList.remove('text-accent');
            //     }
            // });

            document.getElementById('fullscreen-btn').addEventListener('click', function () {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen();
                    this.querySelector('.material-symbols-outlined').textContent = 'fullscreen_exit';
                } else {
                    document.exitFullscreen();
                    this.querySelector('.material-symbols-outlined').textContent = 'fullscreen';
                }
            });

            document.getElementById('share-btn').addEventListener('click', function () {
                if (navigator.share) {
                    navigator.share({
                        title: `Sharrow - ${chapters[currentChapter - 1].title}`,
                        url: window.location.href
                    });
                } else {
                    navigator.clipboard.writeText(window.location.href);
                    alert('Link copied to clipboard!');
                }
            });
        }

        function changeTheme(theme) {
            currentTheme = theme;
            const body = document.body;

            // Remove existing theme classes
            body.classList.remove('theme-sepia', 'theme-dark');

            // Add new theme class
            if (theme !== 'default') {
                body.classList.add(`theme-${theme}`);
            }

            // Update theme button states
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('border-accent');
                btn.classList.add('border-transparent');
            });
            document.querySelector(`[data-theme="${theme}"]`).classList.remove('border-transparent');
            document.querySelector(`[data-theme="${theme}"]`).classList.add('border-accent');

            localStorage.setItem('reader-theme', theme);
        }

        function updateFontSize() {
            document.querySelector('.reading-content').style.fontSize = `${fontSize}px`;
            document.getElementById('font-size-display').textContent = `${fontSize}px`;
            localStorage.setItem('reader-font-size', fontSize);
        }

        function navigateChapter(direction) {
            const newChapter = currentChapter + direction;
            if (newChapter >= 1 && newChapter <= chapters.length) {
                currentChapter = newChapter;
                updateChapterInfo();
                window.history.pushState({}, '', `?chapter=${currentChapter}`);
                window.scrollTo(0, 0);
                // Here you would typically load the new chapter content
            }
        }

        function loadUserSettings() {
            // Load saved settings
            const savedTheme = localStorage.getItem('reader-theme');
            const savedFontSize = localStorage.getItem('reader-font-size');
            const savedLineHeight = localStorage.getItem('reader-line-height');

            if (savedTheme) changeTheme(savedTheme);
            if (savedFontSize) {
                fontSize = parseInt(savedFontSize);
                updateFontSize();
            }
            if (savedLineHeight) {
                document.getElementById('line-height').value = savedLineHeight;
                document.querySelector('.reading-content').style.lineHeight = savedLineHeight;
            }
        }

        // Auto-hide reading controls
        let hideControlsTimeout;
        document.addEventListener('mousemove', function () {
            document.querySelector('.reading-controls').style.opacity = '0.7';
            clearTimeout(hideControlsTimeout);
            hideControlsTimeout = setTimeout(() => {
                document.querySelector('.reading-controls').style.opacity = '0.3';
            }, 3000);
        });

        // Hide toolbar when at the bottom of the page
        function handleToolbarVisibility() {
            const controls = document.querySelector('.reading-controls');
            // 30px threshold from bottom
            if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 30)) {
                controls.style.opacity = '0';
                controls.style.pointerEvents = 'none';
            } else {
                controls.style.pointerEvents = '';
                // Only show if not hidden by auto-hide
                if (!hideControlsTimeout || controls.style.opacity === '0') {
                    controls.style.opacity = '0.7';
                }
            }
        }

        window.addEventListener('scroll', handleToolbarVisibility);
        window.addEventListener('resize', handleToolbarVisibility);
        document.addEventListener('DOMContentLoaded', handleToolbarVisibility);
    </script>
</body>

</html>